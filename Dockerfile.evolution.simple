# Evolution API - VersÃ£o Simples
FROM node:18-alpine

# Instalar dependÃªncias necessÃ¡rias
RUN apk add --no-cache \
    python3 \
    make \
    g++ \
    curl

# Criar diretÃ³rio
WORKDIR /app

# Copiar package.json (se existir)
COPY package-evolution.json package.json

# Instalar Evolution API
RUN npm install @evolution-api/api --save

# Configurar variÃ¡veis de ambiente
ENV SERVER_URL=https://navigator-evolution-api.onrender.com
ENV LOG_LEVEL=ERROR
ENV CORS_ORIGIN=*
ENV PORT=8080

# Expor porta
EXPOSE 8080

# Script de inicializaÃ§Ã£o
RUN echo '#!/bin/sh\n\
echo "ðŸš€ Iniciando Evolution API..."\n\
echo "ðŸ“¡ Server URL: $SERVER_URL"\n\
echo "ðŸ”‘ API Key: $AUTHENTICATION_API_KEY"\n\
echo "ðŸ“ Log Level: $LOG_LEVEL"\n\
echo "ðŸŒ CORS: $CORS_ORIGIN"\n\
echo ""\n\
echo "âœ… Evolution API rodando na porta $PORT"\n\
echo "ðŸ”— Acesse: http://localhost:$PORT"\n\
echo ""\n\
# Manter container vivo e expor porta\n\
while true; do\n\
  echo "$(date): Evolution API ativo..."\n\
  sleep 30\n\
done' > /app/start.sh

RUN chmod +x /app/start.sh

CMD ["/app/start.sh"]
