# ‚úÖ Checklist de Implementa√ß√£o - Melhorias Flowly

**Projeto:** Flowly - Sistema de Onboarding com IA  
**Data de In√≠cio:** 10 de outubro de 2025

---

## üìã Fase 1: Trilhas por Cargo e Departamento (Semanas 1-2)

### üóÑÔ∏è Banco de Dados
- [ ] Executar migra√ß√£o `006_trilhas_segmentacao.sql`
- [ ] Validar que colunas foram criadas em `trilhas`:
  - [ ] `segmentacao_tipo`
  - [ ] `segmentacao_config`
- [ ] Validar cria√ß√£o da tabela `trilha_segmentacao`
- [ ] Testar fun√ß√£o `colaborador_tem_acesso_trilha()`
- [ ] Testar view `trilhas_colaborador`
- [ ] Verificar √≠ndices criados
- [ ] Validar pol√≠ticas RLS

### üîß Backend (API)

#### Endpoints - Trilhas
- [ ] **GET** `/api/trilhas/:id/segmentacao` - Buscar configura√ß√£o de segmenta√ß√£o
- [ ] **PUT** `/api/trilhas/:id/segmentacao` - Atualizar segmenta√ß√£o
- [ ] **GET** `/api/trilhas/colaborador/:userId` - Trilhas dispon√≠veis para colaborador
- [ ] **POST** `/api/trilhas/:id/segmentacao/departamentos` - Adicionar departamentos
- [ ] **POST** `/api/trilhas/:id/segmentacao/cargos` - Adicionar cargos
- [ ] **DELETE** `/api/trilhas/:id/segmentacao/:segId` - Remover segmenta√ß√£o

#### Valida√ß√µes
- [ ] Validar que pelo menos um crit√©rio est√° definido
- [ ] Validar IDs de departamentos/cargos existem
- [ ] Validar permiss√µes de admin
- [ ] Tratar erros de constraint

#### Testes
- [ ] Testar cria√ß√£o de trilha para "todos"
- [ ] Testar cria√ß√£o de trilha para departamento espec√≠fico
- [ ] Testar cria√ß√£o de trilha para cargo espec√≠fico
- [ ] Testar cria√ß√£o de trilha para combina√ß√£o cargo+departamento
- [ ] Testar busca de trilhas por colaborador

### üé® Frontend (Admin)

#### Tela de Configura√ß√£o de Trilhas
- [ ] Adicionar se√ß√£o "Segmenta√ß√£o" no formul√°rio de trilha
- [ ] Radio buttons: "Todos" | "Departamentos" | "Cargos" | "Departamentos + Cargos"
- [ ] Multi-select de departamentos (quando aplic√°vel)
- [ ] Multi-select de cargos (quando aplic√°vel)
- [ ] Preview de quem ter√° acesso √† trilha
- [ ] Salvar configura√ß√£o via API
- [ ] Exibir segmenta√ß√£o atual na lista de trilhas

#### Valida√ß√µes
- [ ] N√£o permitir salvar sem selecionar ao menos um dept/cargo
- [ ] Feedback visual de salvamento
- [ ] Mensagens de erro claras

### ü§ñ N8N Workflow

#### L√≥gica de Roteamento
- [ ] N√≥: Buscar dados do colaborador (cargo + departamento)
- [ ] N√≥: Buscar trilhas aplic√°veis ao colaborador
- [ ] N√≥: Verificar se colaborador tem acesso √† trilha
- [ ] Atualizar mensagens do agente:
  - [ ] Listar trilhas dispon√≠veis para o colaborador
  - [ ] Orientar sobre trilhas espec√≠ficas do cargo/dept
  - [ ] Explicar por que certas trilhas s√£o recomendadas

#### Testes
- [ ] Testar com colaborador de diferentes departamentos
- [ ] Testar com colaborador de diferentes cargos
- [ ] Testar cen√°rio sem departamento/cargo definido
- [ ] Validar que trilhas "para todos" aparecem sempre

### üìö Documenta√ß√£o
- [ ] Documentar API de segmenta√ß√£o
- [ ] Criar guia de uso para admins
- [ ] Atualizar README com nova feature
- [ ] Criar v√≠deo tutorial (opcional)

---

## üìã Fase 2: An√°lise de Sentimento (Semanas 3-4)

### üóÑÔ∏è Banco de Dados
- [ ] Executar migra√ß√£o `005_colaborador_sentimentos.sql`
- [ ] Validar cria√ß√£o da tabela `colaborador_sentimentos`
- [ ] Validar colunas adicionadas em `users`:
  - [ ] `sentimento_atual`
  - [ ] `sentimento_atualizado_em`
- [ ] Testar trigger `trigger_atualizar_sentimento_usuario`
- [ ] Verificar √≠ndices criados
- [ ] Validar pol√≠ticas RLS

### ü§ñ Integra√ß√£o de IA

#### OpenAI / Vertex AI
- [ ] Configurar credenciais da API
- [ ] Criar prompt para an√°lise de sentimento
- [ ] Testar an√°lise com mensagens de exemplo
- [ ] Ajustar prompt para melhor precis√£o
- [ ] Implementar fallback em caso de erro

#### Prompt de An√°lise de Sentimento
```
Exemplo de prompt a criar:
"Analise o sentimento da seguinte mensagem de um colaborador em processo de onboarding.
Classifique como: muito_positivo, positivo, neutro, negativo, muito_negativo.
Forne√ßa intensidade de 0.00 a 1.00.
Identifique palavras-chave, tom e emojis.

Mensagem: {mensagem}

Retorne em JSON:
{
  "sentimento": "...",
  "intensidade": 0.XX,
  "fatores_detectados": {
    "palavras_chave": [],
    "tom": "...",
    "emojis": []
  }
}"
```

- [ ] Criar e testar prompt
- [ ] Validar precis√£o da an√°lise
- [ ] Ajustar conforme necess√°rio

### üîß Backend (API)

#### Endpoints - Sentimentos
- [ ] **POST** `/api/sentimentos` - Registrar sentimento
- [ ] **GET** `/api/sentimentos/colaborador/:userId` - Hist√≥rico de sentimentos
- [ ] **GET** `/api/sentimentos/colaborador/:userId/atual` - Sentimento atual
- [ ] **GET** `/api/sentimentos/estatisticas/:tenantId` - Estat√≠sticas agregadas
- [ ] **GET** `/api/sentimentos/trilha/:trilhaId` - Sentimentos por trilha
- [ ] **GET** `/api/sentimentos/alertas/:tenantId` - Colaboradores com sentimento negativo

#### Valida√ß√µes
- [ ] Validar formato de sentimento
- [ ] Validar intensidade (0.00 - 1.00)
- [ ] Validar origem do sentimento
- [ ] Validar permiss√µes

#### Testes
- [ ] Testar registro de sentimento
- [ ] Testar atualiza√ß√£o autom√°tica em `users`
- [ ] Testar busca de hist√≥rico
- [ ] Testar estat√≠sticas agregadas

### ü§ñ N8N Workflow

#### N√≥s de An√°lise
- [ ] N√≥: Receber mensagem do colaborador
- [ ] N√≥: Chamar API de an√°lise de sentimento (OpenAI/Vertex)
- [ ] N√≥: Parsear resposta da IA
- [ ] N√≥: Salvar sentimento no banco de dados
- [ ] N√≥: Buscar sentimento atual do colaborador
- [ ] N√≥: Decidir tom da resposta baseado no sentimento
- [ ] N√≥: Gerar resposta adaptada

#### L√≥gica de Adapta√ß√£o de Tom
- [ ] **Muito Negativo** ‚Üí Tom emp√°tico, oferecer ajuda imediata
- [ ] **Negativo** ‚Üí Tom compreensivo, dar suporte
- [ ] **Neutro** ‚Üí Tom profissional padr√£o
- [ ] **Positivo** ‚Üí Tom motivador, dar reconhecimento
- [ ] **Muito Positivo** ‚Üí Tom celebrativo, parabenizar

#### Exemplos de Respostas por Sentimento
```
Criar biblioteca de templates:

MUITO_NEGATIVO:
- "Entendo que est√° dif√≠cil. Vamos resolver isso juntos! üíô"
- "Percebo sua frustra√ß√£o. Como posso te ajudar agora?"

NEGATIVO:
- "Vejo que voc√™ est√° com dificuldades. Posso te dar umas dicas?"
- "Sei que pode ser desafiador. Que tal tentarmos de outra forma?"

NEUTRO:
- "Entendido. Vamos continuar?"
- "Certo! Pr√≥ximo passo..."

POSITIVO:
- "Muito bem! Voc√™ est√° indo √≥timo!"
- "Que legal! Continue assim! üëè"

MUITO_POSITIVO:
- "Incr√≠vel! Estou muito feliz com seu progresso! üéâ"
- "Sensacional! Voc√™ √© demais! üåü"
```

- [ ] Criar templates de respostas
- [ ] Implementar l√≥gica de sele√ß√£o
- [ ] Testar com diferentes sentimentos

#### Alertas
- [ ] Criar alerta para sentimento muito_negativo
- [ ] Enviar notifica√ß√£o para gestor/RH
- [ ] Criar task para acompanhamento

### üé® Frontend (Admin)

#### Dashboard de Sentimentos
- [ ] Card: Sentimento m√©dio dos colaboradores
- [ ] Gr√°fico: Evolu√ß√£o de sentimentos ao longo do tempo
- [ ] Gr√°fico: Distribui√ß√£o de sentimentos
- [ ] Lista: Colaboradores com sentimento negativo (alertas)
- [ ] Filtros: Por departamento, cargo, trilha
- [ ] Detalhe: Hist√≥rico de sentimentos por colaborador

#### Detalhes do Colaborador
- [ ] Adicionar se√ß√£o "Sentimento Atual" no perfil
- [ ] Gr√°fico de evolu√ß√£o emocional
- [ ] Hist√≥rico de intera√ß√µes e sentimentos

### üìö Documenta√ß√£o
- [ ] Documentar API de sentimentos
- [ ] Documentar l√≥gica de adapta√ß√£o de tom
- [ ] Guia para interpretar sentimentos
- [ ] Pol√≠tica de privacidade atualizada (LGPD)

---

## üìã Fase 3: Bloco de Notas do Agente (Semanas 5-6)

### üóÑÔ∏è Banco de Dados
- [ ] Executar migra√ß√£o `004_agente_anotacoes.sql`
- [ ] Validar cria√ß√£o da tabela `agente_anotacoes`
- [ ] Verificar √≠ndices criados
- [ ] Validar pol√≠ticas RLS
- [ ] Testar busca por tags (√≠ndice GIN)

### üîß Backend (API)

#### Endpoints - Anota√ß√µes
- [ ] **POST** `/api/agente/anotacoes` - Criar anota√ß√£o
- [ ] **GET** `/api/agente/anotacoes/:tenantId` - Listar anota√ß√µes
- [ ] **GET** `/api/agente/anotacoes/:id` - Detalhes da anota√ß√£o
- [ ] **PUT** `/api/agente/anotacoes/:id` - Atualizar anota√ß√£o
- [ ] **DELETE** `/api/agente/anotacoes/:id` - Remover anota√ß√£o
- [ ] **GET** `/api/agente/anotacoes/colaborador/:userId` - Anota√ß√µes de um colaborador
- [ ] **GET** `/api/agente/anotacoes/trilha/:trilhaId` - Anota√ß√µes de uma trilha
- [ ] **GET** `/api/agente/anotacoes/padroes/:tenantId` - Padr√µes identificados
- [ ] **POST** `/api/agente/anotacoes/:id/gerar-melhoria` - Gerar melhoria a partir de anota√ß√£o

#### Endpoints - An√°lise de Padr√µes
- [ ] **GET** `/api/agente/insights/:tenantId` - Insights autom√°ticos
- [ ] **POST** `/api/agente/analisar-padroes/:tenantId` - For√ßar an√°lise de padr√µes

#### Valida√ß√µes
- [ ] Validar tipo de anota√ß√£o
- [ ] Validar sentimento e intensidade
- [ ] Validar tags (array de strings)
- [ ] Validar permiss√µes

#### Testes
- [ ] Testar cria√ß√£o de anota√ß√£o
- [ ] Testar busca por tags
- [ ] Testar busca por tipo
- [ ] Testar busca por sentimento
- [ ] Testar link com melhorias

### ü§ñ N8N Workflow

#### L√≥gica de Anota√ß√£o Autom√°tica
- [ ] N√≥: Detectar se mensagem cont√©m feedback relevante
- [ ] N√≥: Classificar tipo de anota√ß√£o
- [ ] N√≥: Extrair tags da mensagem
- [ ] N√≥: Analisar sentimento da anota√ß√£o
- [ ] N√≥: Salvar anota√ß√£o no banco
- [ ] N√≥: Atualizar contador de padr√µes

#### Condi√ß√µes para Criar Anota√ß√£o
```
Criar anota√ß√£o quando:
‚úÖ Colaborador menciona dificuldade
‚úÖ Colaborador d√° feedback sobre trilha
‚úÖ Colaborador sugere melhoria
‚úÖ Colaborador expressa sentimento forte (muito positivo/negativo)
‚úÖ Colaborador relata problema t√©cnico

N√ÉO criar anota√ß√£o para:
‚ùå Conversas triviais ("oi", "obrigado")
‚ùå Confirma√ß√µes simples ("sim", "ok")
‚ùå Perguntas j√° respondidas antes
```

- [ ] Implementar l√≥gica de detec√ß√£o
- [ ] Testar precis√£o
- [ ] Ajustar sensibilidade

#### An√°lise Peri√≥dica de Padr√µes
- [ ] Criar workflow agendado (1x/semana)
- [ ] N√≥: Buscar anota√ß√µes relevantes dos √∫ltimos 30 dias
- [ ] N√≥: Agrupar por tipo, trilha, sentimento
- [ ] N√≥: Identificar padr√µes (3+ ocorr√™ncias similares)
- [ ] N√≥: Gerar sugest√µes de melhoria via IA
- [ ] N√≥: Salvar em `onboarding_improvements`
- [ ] N√≥: Marcar anota√ß√µes como `gerou_melhoria = true`
- [ ] N√≥: Notificar admins sobre novas sugest√µes

#### Prompt para Gera√ß√£o de Melhorias
```
Exemplo de prompt:
"Com base nas seguintes anota√ß√µes do agente de IA, sugira uma melhoria 
para o processo de onboarding:

Anota√ß√µes:
- Jo√£o: 'Trilha de RH muito longa' (sentimento: negativo)
- Maria: 'N√£o consegui terminar a trilha de RH no prazo' (sentimento: negativo)
- Pedro: 'RH tem muito conte√∫do' (sentimento: neutro)

Gere uma sugest√£o de melhoria em JSON:
{
  "titulo": "...",
  "descricao": "...",
  "categoria": "conteudo|interface|fluxo|performance|engajamento|acessibilidade|outros",
  "prioridade": "baixa|media|alta|critica",
  "impacto_estimado": "baixo|medio|alto|muito_alto",
  "esforco_estimado": "baixo|medio|alto|muito_alto"
}"
```

- [ ] Criar e testar prompt
- [ ] Validar qualidade das sugest√µes
- [ ] Ajustar conforme necess√°rio

### üé® Frontend (Admin)

#### Dashboard de Anota√ß√µes
- [ ] Card: Total de anota√ß√µes relevantes
- [ ] Card: Padr√µes identificados
- [ ] Card: Melhorias geradas
- [ ] Lista: Anota√ß√µes recentes
- [ ] Filtros: Por tipo, sentimento, colaborador, trilha, tags
- [ ] Busca por tags

#### Dashboard de Insights
- [ ] Card: Insights da semana
- [ ] Lista: Padr√µes identificados
- [ ] Lista: Melhorias sugeridas (pendentes)
- [ ] Gr√°fico: Tipos de feedback mais comuns
- [ ] Gr√°fico: Sentimentos sobre trilhas

#### Tela de Detalhes da Anota√ß√£o
- [ ] Exibir informa√ß√µes completas
- [ ] Hist√≥rico de anota√ß√µes relacionadas
- [ ] Bot√£o: "Gerar Melhoria a partir desta anota√ß√£o"
- [ ] Link para melhoria gerada (se existir)

#### Tela de Melhorias Sugeridas
- [ ] Integrar com `onboarding_improvements` existente
- [ ] Exibir anota√ß√µes que geraram a melhoria
- [ ] Bot√£o: "Aprovar e Implementar"
- [ ] Bot√£o: "Rejeitar"
- [ ] Campo: "Observa√ß√µes"

### üìö Documenta√ß√£o
- [ ] Documentar API de anota√ß√µes
- [ ] Documentar l√≥gica de detec√ß√£o de padr√µes
- [ ] Guia para interpretar insights
- [ ] Exemplos de melhorias geradas

---

## üìã Testes Gerais e Valida√ß√£o

### Testes de Integra√ß√£o
- [ ] Testar fluxo completo: mensagem ‚Üí sentimento ‚Üí anota√ß√£o ‚Üí melhoria
- [ ] Testar com diferentes perfis de colaboradores
- [ ] Testar com diferentes tipos de trilhas
- [ ] Validar performance com grande volume de dados

### Testes de Usabilidade
- [ ] Testar com admins reais
- [ ] Testar com colaboradores reais
- [ ] Coletar feedback
- [ ] Ajustar UX conforme necess√°rio

### Testes de Performance
- [ ] Benchmark de an√°lise de sentimento
- [ ] Benchmark de busca de trilhas
- [ ] Benchmark de an√°lise de padr√µes
- [ ] Otimizar queries lentas

### Testes de Seguran√ßa
- [ ] Validar RLS em todas as tabelas
- [ ] Testar inje√ß√£o SQL
- [ ] Testar acesso n√£o autorizado
- [ ] Validar sanitiza√ß√£o de inputs

---

## üìã Prepara√ß√£o para Produ√ß√£o

### Infraestrutura
- [ ] Validar limites de API (OpenAI/Vertex)
- [ ] Configurar rate limiting
- [ ] Configurar monitoramento de erros
- [ ] Configurar logs estruturados
- [ ] Configurar alertas de performance

### Dados
- [ ] Backup antes de migra√ß√µes
- [ ] Plano de rollback
- [ ] Script de migra√ß√£o de dados legados (se necess√°rio)

### Documenta√ß√£o
- [ ] Atualizar documenta√ß√£o t√©cnica
- [ ] Criar guia de troubleshooting
- [ ] Documentar decis√µes arquiteturais
- [ ] Changelog atualizado

### Treinamento
- [ ] Treinar equipe de suporte
- [ ] Criar materiais de treinamento para admins
- [ ] Criar FAQs
- [ ] Criar v√≠deos tutoriais

---

## üìã Rollout

### Grupo Piloto (Semana 7)
- [ ] Selecionar 2-3 clientes beta
- [ ] Comunicar novidades
- [ ] Ativar features
- [ ] Monitorar m√©tricas
- [ ] Coletar feedback
- [ ] Ajustar conforme necess√°rio

### Rollout Gradual (Semana 8-9)
- [ ] Ativar para 25% dos clientes
- [ ] Monitorar 3 dias
- [ ] Ativar para 50% dos clientes
- [ ] Monitorar 3 dias
- [ ] Ativar para 100% dos clientes

### Comunica√ß√£o
- [ ] Email para clientes sobre novidades
- [ ] Post no blog/changelog
- [ ] Atualizar materiais de marketing
- [ ] Atualizar demos

---

## üìä M√©tricas de Acompanhamento

### Di√°rias
- [ ] N√∫mero de sentimentos capturados
- [ ] N√∫mero de anota√ß√µes criadas
- [ ] Taxa de erro da API de IA
- [ ] Performance de queries

### Semanais
- [ ] Distribui√ß√£o de sentimentos
- [ ] Padr√µes identificados
- [ ] Melhorias sugeridas
- [ ] Taxa de conclus√£o de trilhas

### Mensais
- [ ] NPS dos colaboradores
- [ ] Tempo m√©dio de onboarding
- [ ] Melhorias implementadas
- [ ] ROI das melhorias

---

## ‚úÖ Crit√©rios de Sucesso Final

### Funcionalidade
- ‚úÖ Todas as features implementadas e funcionando
- ‚úÖ Sem bugs cr√≠ticos
- ‚úÖ Performance dentro do esperado
- ‚úÖ Testes passando (>90% cobertura)

### Neg√≥cio
- ‚úÖ NPS dos colaboradores ‚â• 8.0
- ‚úÖ Taxa de conclus√£o de trilhas ‚â• 80%
- ‚úÖ Tempo m√©dio de onboarding ‚â§ 12 dias
- ‚úÖ Melhorias implementadas ‚â• 3/m√™s

### T√©cnico
- ‚úÖ Documenta√ß√£o completa
- ‚úÖ C√≥digo revisado
- ‚úÖ Sem d√≠vidas t√©cnicas cr√≠ticas
- ‚úÖ Equipe treinada

---

**√öltima atualiza√ß√£o:** 10 de outubro de 2025  
**Respons√°vel:** Haendell Lopes

